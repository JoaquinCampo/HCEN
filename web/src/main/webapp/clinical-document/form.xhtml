<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    template="/WEB-INF/templates/layout.xhtml">
    <ui:define name="title">Create Clinical Document</ui:define>
    <ui:define name="content">
        <div class="card shadow-sm">
            <div class="card-body">
                <h:messages id="formMessages" globalOnly="true" styleClass="alert alert-danger" layout="list"
                    infoClass="alert alert-success" warnClass="alert alert-warning" errorClass="alert alert-danger"
                    fatalClass="alert alert-danger" />
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div>
                        <h2 class="card-title h4 mb-0">Create Clinical Document</h2>
                        <small class="text-muted">Attach medical information to a patient's history.</small>
                    </div>
                    <h:link outcome="/clinical-document/list" styleClass="btn btn-outline-secondary">Back to list
                    </h:link>
                </div>

                <h:form styleClass="row g-3">
                    <div class="col-12">
                        <h:outputLabel for="title" value="Title" styleClass="form-label" />
                        <h:inputText id="title" value="#{clinicalDocumentBean.newDocument.title}" required="true"
                            styleClass="form-control" />
                        <h:message for="title" styleClass="form-text text-danger" />
                    </div>

                    <div class="col-12">
                        <h:outputLabel for="contentUrl" value="Document URL" styleClass="form-label" />
                        <h:inputText id="contentUrl" value="#{clinicalDocumentBean.newDocument.contentUrl}"
                            required="true" styleClass="form-control"
                            placeholder="https://s3.amazonaws.com/bucket/document.pdf" />
                        <h:message for="contentUrl" styleClass="form-text text-danger" />
                    </div>

                    <div class="col-md-6">
                        <h:outputLabel for="patient" value="Patient" styleClass="form-label" />
                        <h:selectOneMenu id="patient" value="#{clinicalDocumentBean.selectedPatientId}" required="true"
                            styleClass="form-select">
                            <f:selectItem itemLabel="-- Select Patient --" itemValue="" noSelectionOption="true" />
                            <f:selectItems value="#{clinicalDocumentBean.users}" var="patient" itemValue="#{patient.id}"
                                itemLabel="#{patient.lastName}, #{patient.firstName} (#{patient.document})" />
                        </h:selectOneMenu>
                        <h:message for="patient" styleClass="form-text text-danger" />
                    </div>

                    <div class="col-md-6">
                        <h:outputLabel for="author" value="Author" styleClass="form-label" />
                        <h:selectOneMenu id="author" value="#{clinicalDocumentBean.selectedAuthorId}" required="true"
                            styleClass="form-select">
                            <f:selectItem itemLabel="-- Select Author --" itemValue="" noSelectionOption="true" />
                            <f:selectItems value="#{clinicalDocumentBean.workers}" var="worker" itemValue="#{worker.id}"
                                itemLabel="#{worker.lastName}, #{worker.firstName} (#{worker.licenseNumber})" />
                        </h:selectOneMenu>
                        <h:message for="author" styleClass="form-text text-danger" />
                    </div>

                    <div class="col-md-6">
                        <h:outputLabel for="provider" value="Clinic" styleClass="form-label" />
                        <h:selectOneMenu id="provider" value="#{clinicalDocumentBean.selectedProviderId}"
                            required="true" styleClass="form-select">
                            <f:selectItem itemLabel="-- Select Clinic --" itemValue="" noSelectionOption="true" />
                            <f:selectItems value="#{clinicalDocumentBean.providers}" var="clinic"
                                itemValue="#{clinic.id}" itemLabel="#{clinic.name}" />
                        </h:selectOneMenu>
                        <h:message for="provider" styleClass="form-text text-danger" />
                    </div>

                    <div class="col-12 d-flex gap-2 mt-3">
                        <h:commandButton value="Save" action="#{clinicalDocumentBean.save}"
                            styleClass="btn btn-primary" />
                        <h:commandButton value="Reset" actionListener="#{clinicalDocumentBean.init}" immediate="true"
                            styleClass="btn btn-outline-secondary">
                            <f:ajax render="@form" />
                        </h:commandButton>
                    </div>
                </h:form>
            </div>
        </div>
    </ui:define>
</ui:composition>