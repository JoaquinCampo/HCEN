<ui:composition
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  template="/WEB-INF/templates/layout.xhtml"
>
  <f:metadata>
    <f:viewParam name="name" value="#{providerBean.providerName}" />
    <f:event
      type="preRenderView"
      listener="#{providerBean.loadProviderByName()}"
    />
  </f:metadata>

  <ui:define name="title"
    >#{providerBean.selectedProvider.providerName}</ui:define
  >
  <ui:define name="content">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h:link
          outcome="/provider/list"
          styleClass="btn btn-sm btn-outline-secondary mb-2"
        >
          <i class="bi bi-arrow-left me-1"></i>Volver a Prestadores
        </h:link>
        <h2 class="h3 mb-1">#{providerBean.selectedProvider.providerName}</h2>
        <p class="text-muted mb-0">Clínicas de este prestador</p>
      </div>
      <h:link outcome="/clinic/form" styleClass="btn btn-primary">
        <f:param
          name="providerName"
          value="#{providerBean.selectedProvider.providerName}"
        />
        <i class="bi bi-plus-circle me-2"></i>Nueva clínica
      </h:link>
    </div>

    <h:panelGroup id="clinics" layout="block">
      <ui:fragment rendered="#{not empty providerBean.providerClinics}">
        <div class="card-grid">
          <ui:repeat value="#{providerBean.providerClinics}" var="clinic">
            <div class="card shadow-sm">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-hospital me-2"></i>#{clinic.name}
                </h5>
                <p class="card-text">
                  <i class="bi bi-geo-alt me-1"></i>#{clinic.address}
                </p>
                <div class="small text-muted">
                  <ui:fragment rendered="#{not empty clinic.phone}">
                    <div>
                      <i class="bi bi-telephone me-1"></i>#{clinic.phone}
                    </div>
                  </ui:fragment>
                  <ui:fragment rendered="#{not empty clinic.email}">
                    <div>
                      <i class="bi bi-envelope me-1"></i>#{clinic.email}
                    </div>
                  </ui:fragment>
                </div>
              </div>
              <div class="card-footer">
                <i class="bi bi-calendar me-1"></i>Creado: #{clinic.createdAt}
              </div>
            </div>
          </ui:repeat>
        </div>
      </ui:fragment>

      <ui:fragment rendered="#{empty providerBean.providerClinics}">
        <div class="card shadow-sm">
          <div class="card-body text-center py-5">
            <i
              class="bi bi-hospital"
              style="font-size: 3rem; color: #9ca3af"
            ></i>
            <p class="text-muted mt-3 mb-0">
              No hay clínicas asociadas a este prestador.
            </p>
            <h:link outcome="/clinic/form" styleClass="btn btn-primary mt-3">
              <f:param
                name="providerName"
                value="#{providerBean.selectedProvider.providerName}"
              />
              <i class="bi bi-plus-circle me-2"></i>Crear primera clínica
            </h:link>
          </div>
        </div>
      </ui:fragment>
    </h:panelGroup>
  </ui:define>
</ui:composition>
