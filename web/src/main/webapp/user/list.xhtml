<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Users - JSF</title>
    <meta charset="UTF-8"/>
    <style>
        body { font-family: sans-serif; max-width: 1200px; margin: 24px auto; padding: 0 16px; }
        table { width: 100%; border-collapse: collapse; margin: 16px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f5f5f5; }
        .toolbar { margin: 12px 0; }
        .toolbar input, .toolbar button, .toolbar a { margin-right: 8px; }
        .btn { display: inline-block; padding: 6px 12px; background: #1976d2; color: #fff; text-decoration: none; border-radius: 4px; border: none; }
        .btn:hover { background: #125aa0; }
    </style>
</h:head>
<h:body>
    <h1>Users</h1>
    <h:messages id="msgs" globalOnly="true"/>

    <h:form id="searchForm" styleClass="toolbar">
        <h:inputText id="q" value="#{userBean.searchQuery}" placeholder="Search by name">
            <f:ajax event="keyup" listener="#{userBean.search}" render="results msgs"/>
        </h:inputText>
        <h:commandButton id="btnSearch" value="Search" actionListener="#{userBean.search}" styleClass="btn">
            <f:ajax render="results msgs"/>
        </h:commandButton>
        <h:link outcome="/user/form" value="Add User" styleClass="btn" />
        <h:commandButton id="btnRefresh" value="Refresh" actionListener="#{userBean.loadAll}" styleClass="btn">
            <f:ajax render="results msgs"/>
        </h:commandButton>
    </h:form>

    <h:panelGroup id="results">
        <h:dataTable value="#{userBean.users}" var="u" rendered="#{not empty userBean.users}" styleClass="table">
            <h:column><f:facet name="header">UUID</f:facet>#{u.id}</h:column>
            <h:column><f:facet name="header">DNI</f:facet>#{u.dni}</h:column>
            <h:column><f:facet name="header">Name</f:facet>#{u.lastName}, #{u.firstName}</h:column>
            <h:column><f:facet name="header">Date of Birth</f:facet>#{u.dateOfBirth}</h:column>
            <h:column><f:facet name="header">Gender</f:facet>#{u.gender}</h:column>
            <h:column><f:facet name="header">Email</f:facet>#{empty u.email ? '-' : u.email}</h:column>
            <h:column><f:facet name="header">Phone</f:facet>#{empty u.phone ? '-' : u.phone}</h:column>
            <h:column><f:facet name="header">Address</f:facet>#{empty u.address ? '-' : u.address}</h:column>
        </h:dataTable>

        <h:panelGroup rendered="#{empty userBean.users}">
            <p>No users found.</p>
        </h:panelGroup>
    </h:panelGroup>

    <p>
        <h:link outcome="/index" value="Home"/>
        | <a href="#{request.contextPath}/users">Servlet/JSP List</a>
    </p>
</h:body>
</html>
